\documentclass[11pt,letterpaper,twoside,openright]{book}
%\documentclass[11pt,letterpaper,twoside,openright,draft]{book}

% Input encoding
\usepackage[utf8]{inputenc}

% Margins & Spacing
%\usepackage{showframe}
%\usepackage[top=1.5in,left=1.5in,right=1.5in,bottom=1.75in,showframe]{geometry}
\usepackage[top=1.5in,left=1.5in,right=1.5in,bottom=1.75in]{geometry}
\usepackage{setspace}
\usepackage{ragged2e}
\addtolength{\baselineskip}{0pt plus 2pt minus 1pt}
\usepackage{hanging}
\usepackage{needspace}
\usepackage{fancyhdr}
\usepackage{extramarks}
\fancypagestyle{default}{
  \fancyhead{}
  \fancyfoot{}
  \fancyhead[LE,RO]{\thepage}
  \fancyhead[RE]{\leftmark}
  \fancyhead[LO]{\rightmark}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
}
\pagestyle{default}

% Fonts & Kerning
\usepackage{tgschola} % serif
\usepackage{tgheros} % sans-serif
%\usepackage{tgcursor} % fixed-width
\usepackage{pifont}
\usepackage{amsfonts}
\usepackage[protrusion,expansion,final]{microtype}
\DeclareMicrotypeSet[protrusion,expansion]{rmonly}{family={rm*}}
\DeclareMicrotypeSet[protrusion,expansion]{sfonly}{family={sf*}}
\UseMicrotypeSet[protrusion,expansion]{rmonly}
\usepackage{bm}
\usepackage[english]{babel}
\usepackage[nohyphen]{underscore}

% Figures, Tables, Enumerations, and Itemizes
\usepackage{graphicx}
\usepackage{enumitem}
\usepackage{tikz}
\usetikzlibrary{babel}
% TODO: Good settings here!
%\setitemize{itemsep=4pt,topsep=5pt,parsep=0pt,partopsep=0pt}
\usepackage{afterpage}
\usepackage{multirow}
\usepackage{bigdelim}
\usepackage{booktabs}
\usepackage{array}
\usepackage{listings}

% Bibliography, Citations, and Footnotes
\usepackage[hyphens]{url}
\usepackage{manyfoot}
\newfootnote{Star}
\usepackage{cleveref} % NON-HEVEA
% HEVEA:\usepackage[poorman]{cleveref}
\usepackage[backend=biber,style=authoryear-comp,natbib=true]{biblatex}
\addbibresource{pmawhorter.bib}
%\bibliographystyle{plainnat}

% Misc
\usepackage{xcolor}
\usepackage{xspace}
\usepackage[toc,page]{appendix}


% Hyphenation rules
\hyphenation{play-thr-ough}


% Custom commands
\def\dunyazad/{\textit{Dunyazad}}
\def\minstrel/{\textit{Minstrel}}
\def\skald/{\textit{Skald}}
\def\problemplanets/{\textit{Problem Planets}}
\def\facade/{\textit{Fa\c{c}ade}}
\def\papersplease/{\textit{Papers Please}}

\def\githuburl/{\url{https://github.com/solsword/dunyazad}}

\def\clingo/{\texttt{clingo}}

\def\gng/{\texttt{goal}}
\def\gna/{\texttt{act}}
\def\gns/{\texttt{state}}
\def\gnb/{\texttt{belief}}

\def\gep/{\texttt{plans}}
\def\gei/{\texttt{intends}}
\def\gea/{\texttt{achieves}}
\def\gem/{\texttt{motivates}}

\def\lc/{\cg{*}}

\def\eIobviousabbr/{Obvious}
\def\eIrelaxedabbr/{Relaxed}
\def\eIdilemmaabbr/{Dilemma}

\def\eIqIshort/{1. There are no bad options at this choice.}
\def\eIqIIshort/{2. There is a clear best option at this choice.}
\def\eIqIIIshort/{3. The stakes for this choice are low.}
\def\eIqIVshort/{4. There are no good options at this choice.}
\def\eIqVshort/{5. All [options] are about equally promising.}
\def\eIqVIshort/{6. There are options at this choice. [\ldots]}
\def\eIqVIIshort/{7. This is a difficult choice to make.}
\def\eIqVIIIshort/{8. This choice [has] important consequences.}

\def\eInobadabbr/{1. No bad options.}
\def\eIclearbestabbr/{2. Clear best option.}
\def\eIlowstakesabbr/{3. Low stakes.}
\def\eInogoodabbr/{4. No good options.}
\def\eIbalancedabbr/{5. Option balance.}
\def\eItrickabbr/{6. [trick]. [\ldots]}
\def\eIdifficultabbr/{7. Difficult choice.}
\def\eIconsequencesabbr/{8. Consequences.}

\def\eIIexpectedsuccessabbr/{Expected Success}
\def\eIIexpectedfailureabbr/{Expected Failure}
\def\eIIunexpectedsuccessabbr/{Unexp. Success}
\def\eIIunexpectedfailureabbr/{Unexp. Failure}
\def\eIIobvioussuccessabbr/{Obvious Success}
\def\eIIobviousfailureabbr/{Obvious Failure}
\def\eIIobvioussuccessmainabbr/{Obv. Success [main]}
\def\eIIobviousfailuremainabbr/{Obv. Failure [main]}
\def\eIIobvioussuccessaltabbr/{Obv. Success [alt]}
\def\eIIobviousfailurealtabbr/{Obv. Failure [alt]}

\def\eIIoptobviousabbr/{Clear best}
\def\eIIoptbalancedabbr/{Balanced}
\def\eIIoptnobadabbr/{No bad}
\def\eIIoptnogoodabbr/{No good}
\def\eIIoptstakesabbr/{Low stakes}

\def\eIIoutfairabbr/{Fair}
\def\eIIoutunfairabbr/{Unfair}
\def\eIIoutsenseabbr/{Sense}
\def\eIIoutbrokenabbr/{Broken}
\def\eIIoutgoodabbr/{Good}
\def\eIIoutbadabbr/{Bad}
\def\eIIouthappyabbr/{Satisfied}
\def\eIIoutregretabbr/{Dissatisfied}
\def\eIIoutexpectedabbr/{Expected}
\def\eIIoutunexpectedabbr/{Unexpected}
\def\eIIouttrickabbr/{[Trick]}

\def\eIImotivesshort/{[Which] motive(s) contributed to your decision? [...]}
\def\eIIjudgegoodshort/{[How do you define a ``good'' outcome]?}
\def\eIIjudgebadshort/{[How you define a ``bad'' outcome]?}
\def\eIIconsistencyshort/{Do [you] approach [all experiences] [the same way]?}
\def\eIIothershort/{If you have any other feedback you'd like to give, [enter it here].}

\newcommand{\quoteshape}{\itshape}

\newcommand{\obv}[1]{\prq{obvious}{#1}}
\newcommand{\rlx}[1]{\prq{relaxed}{#1}}
\newcommand{\dlm}[1]{\prq{dilemma}{#1}}

\def\abr/{\discretionary{}{}{}}

\newcommand{\exps}[1]{\prq{expected\_success}{#1}}
\newcommand{\expf}[1]{\prq{expected\_failure}{#1}}
\newcommand{\unxs}[1]{\prq{unexpected\_success}{#1}}
\newcommand{\unxf}[1]{\prq{unexpected\_failure}{#1}}
\newcommand{\obvs}[1]{\prq{obvious\_success}{#1}}
\newcommand{\obvf}[1]{\prq{obvious\_failure}{#1}}
\newcommand{\obvsm}[1]{\prq{obvious\_success\abr/[main]}{#1}}
\newcommand{\obvsa}[1]{\prq{obvious\_success\abr/[alt]}{#1}}
\newcommand{\obvfm}[1]{\prq{obvious\_failure\abr/[main]}{#1}}
\newcommand{\obvfa}[1]{\prq{obvious\_failure\abr/[alt]}{#1}}

\newcommand{\casem}[1]{\prq{[main]}{#1}}
\newcommand{\casea}[1]{\prq{[alt]}{#1}}

% Times symbol with tight kerning
\def\sqtimes{\!\!\times\!\!}

\newcommand{\lbl}[1]{\textbf{\sffamily #1}}
\newcommand{\work}[1]{\textit{#1}}
\newcommand{\exchar}[1]{`\texttt{#1}'\xspace}
\newcommand{\pr}[1]{\texttt{#1}}
\newcommand{\file}[1]{\texttt{#1}}
\newcommand{\prog}[1]{\texttt{#1}}
\newcommand{\prq}[2]{``\texttt{#1}{#2}''}
\newcommand{\ind}{\hspace*{0.8em}}
\newcommand{\svind}{\vspace*{0.3em}}
\newcommand{\vind}{\vspace*{0.5em}}
\newcommand{\cg}[1]{{\leavevmode\color{gray} #1}}
\newcommand{\significant}[1]{\textbf{#1}}
\newcommand{\insignificant}[1]{{\color{cyan} #1}}
\def\nsighcolor/{blue}
%\newcommand{\tenp}{\multicolumn{3}{|c|}{-}}
%\newcommand{\tenplast}{\multicolumn{3}{|c}{-}}
\newcommand{\tenp}{\multicolumn{3}{c}{-}}
\newcommand{\tesig}[3]{\significant{#1} & \significant{#2} & \significant{#3}}
\newcommand{\tensig}[2]{\insignificant{#1} & \insignificant{#2} & \insignificant{$\times$}}
\newcommand{\quotebox}[1]{%
{%
\setlength{\fboxsep}{8pt}%
\begin{center}%
\fbox{%
  \parbox{0.9\textwidth}{%
    #1
  }%
}%
\end{center}%
}%
}
\newcommand{\choicecount}[1]{\fbox{\upshape \sffamily #1}}
\newcommand{\fseed}[1]{\input{fig/framed-seed-#1.tex}}

\newlength{\mydefheight}
\newsavebox{\mydefbox}
\newcommand{\mydef}[3]{%
\savebox{\mydefbox}{%
  \fbox{\parbox{\dimexpr\linewidth-1em-#1}{#3}}%
}%
\settoheight{\mydefheight}{\usebox{\mydefbox}}%
%\addtolength{\mydefheight}{\mydefheight}%
\addtolength{\mydefheight}{1.5\baselineskip}%
%\the\mydefheight
\parbox[b][\dimexpr\mydefheight][c]{#1}{%
#2%
}%
\hspace{1em}%
\parbox[b][\dimexpr\mydefheight][c]{\dimexpr\linewidth-1em-#1}{%
#3%
}%
}

% File listings:
\lstset{%
  language=Prolog,%
  basicstyle=\scriptsize\ttfamily,%
  commentstyle=\ttfamily\itshape\color{gray},%
  numbers=left,%
  numberfirstline=true,%
  numberstyle=\tiny,%
  stepnumber=5,%
  numbersep=8pt,%
  xleftmargin=18pt,%
  captionpos=t%
}
\fancypagestyle{listing}{
  \fancyhead{}
  \fancyfoot{}
  \fancyhead[LE,RO]{\thepage}
  \fancyhead[RE]{\leftmark}
  \fancyhead[LO]{\rightmark}
  \renewcommand{\headrulewidth}{0pt}
  \renewcommand{\footrulewidth}{0pt}
  \fancyfoot[CO,CE]{---~\texttt{\lastxmark}~---}
}
\newcommand{\lfile}[3]{%
{
\vspace*{2\baselineskip}
\setstretch{1.2}
\addtolength{\baselineskip}{0pt plus 1pt minus 1pt}
\centering
\needspace{8\baselineskip}
\textbf{---~\large\texttt{#2}~---} \\
\vspace*{0.7\baselineskip}
\extramarks{#2}{#2}
\hrule
\raggedright
\lstinputlisting[firstnumber=1,name=#2,label=#3]{#1}
\extramarks{}{}
}
}


\DeclareRobustCommand\encircle[1]{% NON-HEVEA
\tikz[baseline=(X.base)]  % NON-HEVEA
\node (X) [draw, shape=circle, inner sep=0, line width=0.75pt] {% NON-HEVEA
\small \sffamily \strut #1% NON-HEVEA
};% NON-HEVEA
} % NON-HEVEA
% HEVEA:\newcommand{\encircle}[1]{(#1)}

\begin{document}
\frontmatter

% Title page
% Copyright page
% Table of contents
% List of figures
% List of tables
% Abstract
% Dedication
% Acknowledgements
% Preface
\input{front.tex}

\setstretch{1.5}
\addtolength{\baselineskip}{0pt plus 1pt minus 1pt}
%\renewcommand{\baselinestretch}{1.5}

\mainmatter

% Main chapters
% Appendices

\input{ch-intro.tex}
\input{ch-method.tex}
\input{ch-related-work.tex}
% Minstrel:
\input{ch-skald.tex}
% Dunyazad:
\input{ch-choice-poetics.tex}
\input{ch-dunyazad.tex}
\input{ch-option-results.tex}
\input{ch-outcome-results.tex}
\input{ch-conclusion.tex}

% This nixes chapter headings which we need later for the appendices...
%\backmatter

% Bibliography
\printbibliography
% Index?

\appendix
\begin{appendices}
\input{ap-nlg.tex}
\clearpage
\input{ap-src.tex}
\end{appendices}

\end{document}
